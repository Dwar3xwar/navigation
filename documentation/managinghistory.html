<html>
<head>
    <title>Managing History</title>
    <link href="../github.css" rel="stylesheet" />
    <link href="documentation.css" rel="stylesheet" />
</head>
<body>
    <div id="header">
        <div id="banner">
            <a id="home" href="../index.html">Navigation</a>
            <a href="../tutorial/configuringstates.html">Tutorial</a>
            <a href="../example/angular/navigation.html">Examples</a>
            <a href="../download/index.html">Download</a>
            <a class="active" href="historymanagement.html">Documentation</a>
            <a href="https://github.com/grahammendick/navigation">GitHub Source</a>
        </div>
    </div>
    <div id="content">
        <div id="nav">
            <h3></h3>
            <ul>
                <li><a href="configuring.html">Configuring</a></li>
                <li><a href="changingstate.html">Changing State</a></li>
                <li class="active"><a href="managinghistory.html">Managing History</a></li>
            </ul>
        </div>
        <div id="doc">
            <h1>Managing History</h1>
            <p>
                Navigation supports Hash or HTML5 history. By default it's configured to use Hash history but you can
                change this to HTML5 history:
                <pre><code class="javascript">Navigation.settings.historyManager = new Navigation.HTML5HistoryManager();
//If your urls look like http://domain/app/route, you need to set the application path
Navigation.settings.applicationPath = '/app';</code></pre>
                <em>Make sure you set the history manager before calling <code>Navigation.start();</code></em>
            </p>
            <h2>Browser Support</h2>
            <p>
                Regardless of whether you choose Hash or HTML5 history, Navigation works in all browsers. Navigation uses progressive enhancement
                to achieve this unparalleled level of support. If you opt for HTML5 history management then, in Internet Explorer < 10, Navigation
                still works but the history management is disabled. So, your app is fully functional (assuming your application code works in
                Internet Explorer < 10), it's just that the Url doesn't change.
            </p>
            <p>
                Some routers fall back to Hash history if HTML5 History isn't available, but supporting two different Url schemes causes problems.
                Imagine you're emailing your users with a hyperlink to a promotional offer. 95% of your users are on modern browsers, so
                you send out the HTML5 hyperlink. Because this Url doesn't work for the older browsers, you're in the unenviable position
                of having to do difficult development to cater for those 5%. That runs counter to principle of progressive enhancement. With
                Navigation, you don't have this problem because there's only ever one Url scheme in place.
            </p>
            <h3>Hash History and Internet Explorer 6 & 7</h3>
            <p>
                If you're using Hash history management and you want to support Internet Explorer 6 or 7 then you'll need to set:
                <pre><code class="javascript">Navigation.settings.historyManager.replaceQueryIdentifier = true;</code></pre>
            </p>
            <p>
                Internet Explorer 6 and 7 are buggy when a '?' appears in the Url's hash. The above setting replaces the '?' with a '#'. Navigation 
                only has one Url scheme, so this setting applies in all browsers.
            </p>
            <h2>Custom History</h2>
            <p>
                If you don't like Navigation's opinions on history management then you can implement your own history manager. Here's a history
                manager that uses HTML5 history's replaceState for the listing State and pushState for all the others.
            </p>
            <pre><code class="javascript">Navigation.settings.historyManager = {
    init: function(){
        // Listen for Url changes and navigate when it does
        window.addEventListener('popstate', function(){
            Navigation.StateController.navigateLink(location.pathname + location.search);
        });
    },
    addHistory: function(state, url){
        // Set the current Url from the url passed in
        if (location.pathname + location.search !== url){
            if (state.key !== 'listing')
                window.history.pushState(null, null, url);
            else
                window.history.replaceState(null, null, url);
        }
    },
    getCurrentUrl: function(){
        // Return the current Url
        return location.pathname + location.search;
    },

    // The following two functions are only used by the Navigation plugins
    getHref: function(url){
        // Return the Href for the url passed in
        return url;
    },
    getUrl: function(anchor){
        // Return the Url for the anchor passed in
        return anchor.pathname + anchor.search;
    }
};</code></pre>
        </div>
    </div>
    <script src="../highlight.pack.js"></script>
    <script>
        hljs.initHighlightingOnLoad();
    </script>
</body>
</html>