<html>
<head>
    <title>Remembering Data</title>
    <link href="../github.css" rel="stylesheet" />
    <link href="documentation.css" rel="stylesheet" />
</head>
<body>
    <div id="header">
        <div id="banner">
            <a id="home" href="../index.html">Navigation</a>
            <a href="../tutorial/configuringstates.html">Tutorial</a>
            <a href="../example/angular/navigation.html">Examples</a>
            <a href="../download/index.html">Download</a>
            <a class="active" href="configuring.html">Documentation</a>
            <a href="https://github.com/grahammendick/navigation">GitHub Source</a>
        </div>
    </div>
    <div id="content">
        <div id="nav">
            <h3></h3>
            <ul>
                <li><a href="configuring.html">Configuring</a></li>
                <li><a href="changingstate.html">Changing State</a></li>
                <li><a href="changingdata.html">Changing Data</a></li>
                <li class="active"><a href="rememberingdata.html">Remembering Data</a></li>
                <li><a href="handlingnavigation.html">Handling Navigation</a></li>
                <li><a href="settingdatadefaults.html">Setting Data Defaults</a></li>
                <li><a href="hyperlinking.html">Hyperlinking</a></li>
                <li>
                    Working With:
                    <ul>
                        <li><a href="workingwith/angular.html">Angular</a></li>
                        <li><a href="workingwith/knockout.html">Knockout</a></li>
                        <li><a href="workingwith/react.html">React</a></li>
                    </ul>
                </li>
                <li><a href="unloadingviews.html">Unloading Views</a></li>
                <li><a href="managinghistory.html">Managing History</a></li>
                <li><a href="layingcrumbtrail.html">Laying a Crumb Trail</a></li>
            </ul>
        </div>
        <div id="doc">
            <h1>Remembering Data</h1>
            <p>
                <a href="changingdata.html">Changing data</a> when navigating is only half the story. Just as important is remembering data that the
                user's already selected. In the example email application, when a user pages through their inbox, you mustn't forget their sort order.
                Or, when returning from the mail details to the inbox, you must remember the page of the inbox they came from. Navigation keeps track
                of this current data so you don't have to.
            </p>
            <p>
                To help a user manage their inbox, you've added a button that sorts the mail by the sender. Sorting is an example of a
                <a href="changingdata.html#refresh">refresh navigation</a> because it changes the data but doesn't change the State:
                <pre><code class="javascript">Navigation.StateController.refresh({ sort: 'sender' });</code></pre>
            </p>
            <p>
                If the user clicks 'next' to go to the second page of their sorted inbox, the refresh navigation has to pass the new page number. But,
                it also has to pass the current sort order which it must get from your sorting component:
                <pre><code class="javascript">// The sorting component provides the current sort order
var data = { pageNumber: 2, sort: sortingComponent.selectedValue };
Navigation.StateController.refresh(data);</code></pre>
            </p>
            <p>
                Unwittingly, you've tightly coupled your paging and sorting components together. You can remove this coupling by letting Navigation
                populate the current sort order for you. You call the includeCurrentData function on the StateContext object, passing your new data
                together with the keys of the current data that you want to keep. Here's the same navigation to the second page of the sorted inbox,
                this time circumventing the sorting component:
                <pre><code class="javascript">// Includes the new pageNumber and current sort order
var data = Navigation.StateContext.includeCurrentData({ pageNumber: 2 }, ['sort']);
Navigation.StateController.refresh(data);</code></pre>
            </p>
            <p>
                You decide to add search functionality to the inbox UI. When a user goes to the second page, you have to remember both the sort order
                and the filter applied. You could do this by passing both keys to the includeCurrentData method:
                <pre><code class="javascript">var data = Navigation.StateContext.includeCurrentData({ pageNumber: 2 }, ['sort','filter']);
Navigation.StateController.refresh(data);</code></pre>
            </p>
            <p>
                But, listing the current data keys is overkill when the intention of the paging navigation is to retain all the current data except the
                page number. If you pass just the new data to includeCurrentData, omitting the second parameter, then it includes all the current data by
                default. Here's the same navigation to the second page of the sorted and filtered inbox:
                <pre><code class="javascript">// Includes the new pageNumber, current sort order and current filter
var data = Navigation.StateContext.includeCurrentData({ pageNumber: 2 });
Navigation.StateController.refresh(data);</code></pre>
            </p>
            <h2>Back Navigation</h2>
            <p>
                A user that selects a mail from the second page of their inbox expects to be returned to the second page when they close that mail. But, to
                return to the inbox, you're using <a href="changingstate.html#back">back navigation</a> which doesn't allow you to pass data.
            </p>
            <p>
                Navigation dynamically builds a breadcrumb trail by tracking States visited as you navigate along Transitions. When Navigation adds a State
                to the trail, it also adds that State's current data. When you navigate back along this trail, Navigation returns you to the visited State
                and passes along this saved data. So, not only will the user be returned to the page they were on, but their sort and filter criteria will
                also be remembered.
                <pre><code class="javascript">// Remembers the pageNumber, sort order and filter
Navigation.StateController.navigateBack(1);</code></pre>

            </p>
        </div>
    </div>
    <script src="../highlight.pack.js"></script>
    <script>
        hljs.initHighlightingOnLoad();
    </script>
</body>
</html>