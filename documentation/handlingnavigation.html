<html>
<head>
    <title>Handling Navigation</title>
    <meta name="viewport" content="width=device-width">
    <link href="../github.css" rel="stylesheet" />
    <link href="documentation.css" rel="stylesheet" />
</head>
<body>
    <div id="header">
        <div id="banner">
            <a id="home" href="../index.html">Navigation</a>
            <a href="../tutorial/configuringstates.html">Tutorial</a>
            <a href="../example/angular/navigation.html">Examples</a>
            <a href="../download/index.html">Download</a>
            <a class="active" href="configuring.html">Documentation</a>
            <a href="https://github.com/grahammendick/navigation">GitHub Source</a>
        </div>
    </div>
    <div id="content">
        <div id="nav">
            <h3></h3>
            <ul>
                <li><a href="configuring.html">Configuring</a></li>
                <li><a href="changingstate.html">Changing State</a></li>
                <li><a href="changingdata.html">Changing Data</a></li>
                <li><a href="rememberingdata.html">Remembering Data</a></li>
                <li class="active"><a href="handlingnavigation.html">Handling Navigation</a></li>
                <li><a href="settingdatadefaults.html">Setting Data Defaults</a></li>
                <li><a href="hyperlinking.html">Hyperlinking</a></li>
                <li>
                    Working With:
                    <ul>
                        <li><a href="workingwith/angular.html">Angular</a></li>
                        <li><a href="workingwith/knockout.html">Knockout</a></li>
                        <li><a href="workingwith/react.html">React</a></li>
                    </ul>
                </li>
                <li><a href="unloadingviews.html">Unloading Views</a></li>
                <li><a href="managinghistory.html">Managing History</a></li>
                <li><a href="navigatingisomorphically.html">Navigating Isomorphically</a></li>
                <li><a href="layingcrumbtrail.html">Laying a Crumb Trail</a></li>
            </ul>
        </div>
        <div id="doc">
            <h1>Handling Navigation</h1>
            <p>
                After a navigation's happened, you need to take some action. In the email application example, when a user selects a mail from their inbox,
                you need to fetch and display the mail's details.
            </p>
            <p>
                To be notified after a navigation takes place, you need a State Navigator. A State Navigator is built by attaching functions to States,
                allowing you to hook into various points in the navigation lifecycle. Things would get messy if you had to create the State Navigator as
                part of the <a href="configuring.html">configuration</a>. So, Navigation provides access to Dialogs and States post configuration, via the
                StateInfoConfig object. The keys from the configuration become the property names, for example, here's how to access the 'inbox' Dialog and
                its 'details' State:
                <pre><code class="javascript">var inbox = Navigation.StateInfoConfig.dialogs.inbox;
var details = inbox.states.details;</code></pre>
            </p>
            <p>
                To create a State Navigator, you can assign a function to that State's navigated property. Whenever that State is navigated to, the function is
                called along with any data passed during the navigation. Here's a State Navigator for the 'details' State that has the mail id passed in:
                <pre><code class="javascript">var details = inbox.states.details;
details.navigated = function(data) {
    var id = data.id;
    // Fetch and display the mail details
}</code></pre>
            </p>
            <p>
                The navigated function fires after the navigation's happened and so, for the time it takes to fetch the email details, the user will be shown
                a blank screen. You can fix this by pausing the navigation and only continuing with it once you've loaded the email details. To pause a
                navigation you assign a function to a State's navigating property. Once your asynchronous calls complete you can continue with the navigation
                by calling the navigate function passed in, supplying the retrieved data.
                <pre><code class="javascript">var details = inbox.states.details;
details.navigating = function(data, url, navigate, history) {
    // Fetch the mail details
    var details = getDetails(data.id, function(resp){
        // Continue the navigation
        navigate({ details: resp.details });
    });
}</code></pre>
            </p>
            <p>
                To access the mail details returned asynchronously, add an asyncData parameter to the navigated function:
                <pre><code class="javascript">details.navigated = function(data, asyncData) {
    // Display the mail details
    var details = asyncData.details;
}</code></pre>
            </p>
            <p>
                A State Navigator isn't aware of the type of navigation that triggered it. It could've been a navigation to a Dialog or along a Transition,
                a back navigation or a refresh. In <a href="unloadingviews.html">Unloading Views</a>, you can read about a couple more functions that 
                make up a State Navigator.
            <p>
                Once your State Navigators are created, you should call <code>Navigation.start()</code>. This executes an initial navigation to match the 
                current State to the browser Url. 
            </p>
        </div>
    </div>
    <script src="../highlight.pack.js"></script>
    <script>
        hljs.initHighlightingOnLoad();
    </script>
</body>
</html>