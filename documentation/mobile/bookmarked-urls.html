<html>
<head>
    <title>Bookmarked Urls</title>
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="../../css/prism.css">
    <link rel="stylesheet" href="../../css/navigation.css">
</head>
<body>
    <div id="banner">
        <div>
            <a href="../../index.html">Navigation</a>
            <a href="../hello-world.html" class="selected">Docs</a>
            <a href="../../download/index.html">Download</a>
            <a id="github" href="https://github.com/grahammendick/navigation">GitHub source</a>
        </div>
    </div>
    <div id="content">
        <div id="menu">
            <a href="../hello-world.html">Hello World</a>
            <a href="../thinking-in-navigation.html">Thinking in Navigation</a>
            <div class="separator"></div>
            <h2>THE ABC</h2>
            <a href="../state-navigation.html">A. State Navigation</a>
            <a href="../navigation-data.html">B. Navigation Data</a>
            <a href="../routes.html">C. Routes</a>
            <a href="../examples.html">Examples</a>
            <div class="separator"></div>
            <h2>FURTHER GUIDES</h2>
            <a href="../current-data.html">Current Data</a>
            <a href="../html5-history.html">HTML5 History</a>
            <a href="../navigation-lifecycle.html">Navigation Lifecycle</a>
            <a href="../reusable-components.html">Reusable Components</a>
            <div class="separator"></div>
            <h2>MOBILE</h2>
            <a href="hello-world.html">Hello World</a>
            <a href="animated-navigation.html">Animated Navigation</a>
            <a href="non-animated-navigation.html">Non-Animated Navigation</a>
            <a href="clean-urls.html">Clean Urls</a>
            <a href="bookmarked-urls.html" class="selected">Bookmarked Urls</a>
            <a href="shared-element-navigation.html">Shared Element Navigation</a>
            <a href="examples.html">Examples</a>
            <div class="separator"></div>
            <h2>NATIVE</h2>
            <a href="../native/setup.html">Setup</a>
            <a href="../native/hello-world.html">Hello World</a>
            <a href="../native/push-navigation.html">Push Navigation</a>
            <a href="../native/pop-navigation.html">Pop Navigation</a>
            <a href="../native/navigation-bar.html">Navigation Bar</a>
            <a href="../native/tab-bar.html">Tab Bar</a>
            <a href="../native/modal.html">Modal</a>
            <a href="../native/custom-animation.html">Custom Animation (Android)</a>
            <a href="../native/shared-element-transition.html">Shared Element Transition (Android)</a>
            <a href="../native/deep-links.html">Deep Links</a>
            <a href="../native/examples.html">Examples</a>
        </div>
        <div id="article">
            <h1>Bookmarked Urls</h1>
            <h2>Priming the Stack</h2>
            <p>
                A user visiting a bookmarked email will find that the Hyperlink taking them back to their inbox is disabled. The bookmark takes the user straight to their open email, bypassing the inbox, so the stack of scenes is empty and they can't navigate back. We can re-enable the Hyperlink by prepopulating the breadcrumb trail so it looks like the user came from the 'inbox' scene. We can build this Url by using the Navigation router's fluent navigation to simulate the user opening the email from their inbox.
            </p>
            <pre><code class="language-jsx">var url = stateNavigator.fluent()
  .navigate('inbox')
  .navigate('mail', {id: 12}).url;</code></pre>
            <p>
                We change the startup Url by passing a function into the <code>MobileHistoryManager</code> constructor. The function receives the browser Url and we use fluent navigation to return the new Url with the 'inbox' breadcrumb included. We extract the bookmarked email Id from the incoming Url using the <code>parseLink</code> function on the <code>stateNavigator</code>.
            </p>
            <pre><code class="language-jsx">new NavigationReactMobile.MobileHistoryManager(function(url) {
  var {state, data} = stateNavigator.parseLink(url);
  return stateNavigator.fluent()
    .navigate('inbox')
    .navigate(state.key, data).url;
})</code></pre>
            <h2>Priming the Browser History</h2>
            <p>
                Remember that when the user taps the Hyperlink we’re <a href="animated-navigation.html#navigating-back">calling the history back function</a> to take them to their inbox. Because the user jumped directly to the bookmarked email, the 'inbox' Url isn’t in their browser history. So, even though the Hyperlink is enabled, it still doesn’t work. We can fix this by replacing the current Url with the 'inbox' Url. That way, the 'inbox' Url ends up in browser history when the Navigation router pushes the bookmarked Url on startup.
            </p>
            <pre><code class="language-jsx">new NavigationReactMobile.MobileHistoryManager(function(url) {
  var {state, data} = stateNavigator.parseLink(url);
  var fluent = stateNavigator.fluent().navigate('inbox');
  // replace the current Url with 'inbox' Url
  stateNavigator.historyManager.addHistory(fluent.url, true);
  return fluent.navigate(state.key, data).url;
})</code></pre>
        </div>
    </div>
    <script type="text/javascript" src="../../js/prism.js"></script>
</body>
</html>