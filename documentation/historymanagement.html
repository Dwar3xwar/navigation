<html>
<head>
    <title>History Management</title>
    <link href="../github.css" rel="stylesheet" />
    <link href="documentation.css" rel="stylesheet" />
</head>
<body>
    <div id="header">
        <div id="banner">
            <a id="home" href="../index.html">Navigation</a>
            <a href="../tutorial/configuringstates.html">Tutorial</a>
            <a href="../example/angular/navigation.html">Examples</a>
            <a href="../download/index.html">Download</a>
            <a class="active" href="historymanagement.html">Documentation</a>
            <a href="https://github.com/grahammendick/navigation">GitHub Source</a>
        </div>
    </div>
    <div id="content">
        <div id="nav">
            <h3></h3>
            <ul>
                <li class="active"><a href="historymanagement.html">History Management</a></li>
            </ul>
        </div>
        <div id="doc">
            <h1>History Management</h1>
            <p>
                Navigation supports Hash or HTML5 history. By default it's configured to use Hash history but you can
                change this to HTML5 history:
                <pre><code class="javascript">Navigation.settings.historyManager = new Navigation.HTML5HistoryManager();</code></pre>
                <em>Make sure you set this before calling <code>Navigation.start();</code></em>
            </p>
            <h2>Browser Support</h2>
            <p>
                Regardless of whether you choose Hash or HTML5 history, Navigation works in all browsers. Navigation uses progressive
                enhancement to achieve this unparalleled level of support. If you choose HTML5 history management 
                and someone uses Internet Explorer 9 then Navigation will still work but the history management will be disabled. So, your app 
                will be fully functional (assuming your application code works in Internet Explorer 9) but the Url won't change.
            </p>
            <p>
                You might have seen other routers use HTML5 history in modern browsers and fall back to Hash history in older browsers. 
                Having two different Url schemes creates problems. Imagine you've got an email campaign and you need to send out a deep 
                link to one of your pages. What Url do you sent out? Even if you could send two different emails, one with the Hashed 
                Url and one with the HTML5 Url, you don't know which user would need which email. So, you choose to mail out the HTML5 one 
                because it's a cleaner Url. But now you have to put in code for old browsers to handle HMTL5 Urls. Not only is this code 
                tricky to write, but how do you get your hands on all the browsers that don't support HTML5 history in order to test this code?
            </p>
            <p>
                With Navigation, you don't have this problem because there's only ever one Url scheme in place.
            </p>
            <h3>Hash History and Internet Explorer 6 & 7</h3>
            <p>
                If you're using Hash history management and you want to support Internet Explorer 6 or 7 then you'll need to set:
                <pre><code class="javascript">Navigation.settings.historyManager.replaceQueryIdentifier = true;</code></pre>
            </p>
            <p>
                Those browsers handling of a '?' in the Url's hash are buggy and the above setting will replace it with a '#'. Because Navigation
                only has one Url scheme, the query identifier will be replaced in all browsers.
            </p>
            <h2>Custom History</h2>
            <p>
                If you don't like Navigation's opinions on history management then you can implement your own history manager. Here's a history
                manager that uses HTML5 history's replaceState for the listing State and pushState for all the others.
            </p>
            <pre><code class="javascript">Navigation.settings.historyManager = {
    init: function(){
        // Listen for Url changes and navigate when it does
        window.addEventListener('popstate', function(){
            Navigation.StateController.navigateLink(location.pathname + location.search);
        });
    },
    addHistory: function(state, url){
        // Set the current Url from the url passed in
        if (location.pathname + location.search !== url){
            if (state.key !== 'listing')
                window.history.pushState(null, null, url);
            else
                window.history.replaceState(null, null, url);
        }
    },
    getCurrentUrl: function(){
        // Return the current Url
        return location.pathname + location.search;
    },

    // The following two functions are only used by the Navigation plugins
    getHref: function(url){
        // Return the Href for the url passed in
        return url;
    },
    getUrl: function(anchor){
        // Return the Url for the anchor passed in
        return anchor.pathname + anchor.search;
    }
};</code></pre>
        </div>
    </div>
    <script src="../highlight.pack.js"></script>
    <script>
        hljs.initHighlightingOnLoad();
    </script>
</body>
</html>