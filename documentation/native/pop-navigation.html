<html>
<head>
    <title>Pop Navigation</title>
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="../../css/prism.css">
    <link rel="stylesheet" href="../../css/navigation.css">
</head>
<body>
    <div id="banner">
        <div>
            <a href="../../index.html">Navigation</a>
            <a href="../hello-world.html" class="selected">Docs</a>
            <a href="../../download/index.html">Download</a>
            <a id="github" href="https://github.com/grahammendick/navigation">GitHub source</a>
        </div>
    </div>
    <div id="content">
        <div id="menu">
            <a href="../hello-world.html">Hello World</a>
            <a href="../thinking-in-navigation.html">Thinking in Navigation</a>
            <div class="separator"></div>
            <h2>THE ABC</h2>
            <a href="../state-navigation.html">A. State Navigation</a>
            <a href="../navigation-data.html">B. Navigation Data</a>
            <a href="../routes.html">C. Routes</a>
            <a href="../examples.html">Examples</a>
            <div class="separator"></div>
            <h2>FURTHER GUIDES</h2>
            <a href="../current-data.html">Current Data</a>
            <a href="../html5-history.html">HTML5 History</a>
            <a href="../navigation-lifecycle.html">Navigation Lifecycle</a>
            <a href="../reusable-components.html">Reusable Components</a>
            <div class="separator"></div>
            <h2>MOBILE</h2>
            <a href="../mobile/hello-world.html">Hello World</a>
            <a href="../mobile/animated-navigation.html">Animated Navigation</a>
            <a href="../mobile/non-animated-navigation.html">Non-Animated Navigation</a>
            <a href="../mobile/clean-urls.html">Clean Urls</a>
            <a href="../mobile/shared-element-navigation.html">Shared Element Navigation</a>
            <a href="../mobile/examples.html">Examples</a>
            <div class="separator"></div>
            <h2>NATIVE</h2>
            <a href="setup.html">Setup</a>
            <a href="hello-world.html">Hello World</a>
            <a href="push-navigation.html">Push Navigation</a>
            <a href="pop-navigation.html" class="selected">Pop Navigation</a>
            <a href="custom-animation.html">Custom Animation (Android)</a>
            <a href="shared-element-transition.html">Shared Element Transition (Android)</a>
            <a href="ui-bar-buttons.html">UI Bar Buttons (iOS)</a>
            <a href="deep-links.html">Deep Links</a>
            <a href="tabs-setup.html">Tabs Setup (iOS)</a>
            <a href="examples.html">Examples</a>
        </div>
        <div id="article">
            <h1>Pop Navigation</h1>
            <h2>Popping</h2>
            <p>
                Because the Navigation router pushes scenes using the native APIs, the user can pop them via the Android back button or swiping/pressing back on iOS. You can also programmatically pop scenes by calling the <code>navigateBack</code> function on the <code>StateNavigator</code>. The number you pass in indicates the number of scenes to pop. In our email example, we can add a button to the 'compose' scene that returns the user to the inbox.
            </p>
            <pre><code class="language-jsx">import {NavigationContext} from 'navigation-react';

var Compose = () => (
  &lt;NavigationContext.Consumer>
    {({stateNavigator}) => (
      &lt;TouchableHighlight
        onPress={() => {
          stateNavigator.navigateBack(1);
        }}>
        &lt;Text>Back to Inbox&lt;/Text>
      &lt;/TouchableHighlight>
    )}
  &lt;/NavigationContext.Consumer>
);</code></pre>
            <h2>Popping to Top</h2>
            <p>
                The Navigation router is the only React Native router that navigates natively on Android and iOS where you can interrogate the stack in JavaScript. You recall that the Navigation router drops a breadcrumb at each visited scene, just like the fairy-tale characters Hansel and Gretel. The stack of visited scenes is represented in JavaScript as an array of breadcrumbs. Each crumb corresponds to a visited scene and holds the <code>State</code> and navigation data associated with it.
            </p>
            <p>
                Let's use this array of crumbs to make the 'Back to Inbox' button work regardless of the route the user takes to get to the 'compose' scene. For example, if the user presses the 'Compose Mail' button after opening an email, then popping one scene off the stack goes back to the open email instead of the inbox. We ensure the 'Back to Inbox' button always pops to the top of the stack by navigating back the length of the <code>crumbs</code> array.
            </p>
            <pre><code class="language-jsx">var {crumbs} = stateNavigator.stateContext;
stateNavigator.navigateBack(crumbs.length);</code></pre>
            <h2>Pushing when Popping</h2>
            <p>
                By default, each navigation adds one scene to the stack. You can change this behaviour by attaching a truncateCrumbTrail function to a State. During a navigation, the Navigation router calls this function on the destination State. It passes in the provisional stack, as an array of Crumbs, and you return the modified stack. Dropping a crumb from the array removes the corresponding scene in the stack.
            </p>
            <p>
                In the email example, we can add a button to the mail scene that expands the email so the user can view the full conversation. On click, we navigate to the mail scene again and pass an expand boolean in navigation data. We must remove the scene showing the collapsed email from the stack so that navigating back still returns the user to their inbox. Put another way, we must prevent consecutive occurrences of the mail State from appearing in the Crumbs array.
            </p>
        </div>
    </div>
    <script type="text/javascript" src="../../js/prism.js"></script>
</body>
</html>