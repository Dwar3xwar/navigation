<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Navigation KO</title>
    <script src="../../Sample/app.data.js"></script>
    <script src="../../Navigation.Routing.js"></script>
    <script src="../../Navigation.js"></script>
    <script src="../../Sample/Knockout/knockout-3.3.0.js"></script>
    <script src="../../Navigation.Knockout.js"></script>
    <style>
        table{border-collapse:collapse;}table,td,th{border:1px #000 solid;}
        ul{list-style-type:none;padding:0;margin:0;}li{float:left;padding-right:3px;}
    </style>
</head>
<body>
    <table>
        <thead>
            <tr>
                <th><a data-bind="refreshLink: { sortExpression: sortExpression }">Name</a></th>
                <th>Date of Birth</th>
            </tr>
        </thead>
        <tbody data-bind="foreach: people">
            <tr>
                <td><a data-bind="text: name, navigationLink: 'select', toData: { id: id }"></a></td>
                <td data-bind="text: dateOfBirth.toLocaleDateString()"></td>
            </tr>
        </tbody>
    </table>
    <script type="text/javascript">
        function PersonViewModel() {
            var self = this;
            self.people = ko.observableArray();
            self.sortExpression = ko.observable();

	        var webMailStates = Navigation.StateInfoConfig.dialogs.person.states;
	        webMailStates.list.navigated = function (data) {
	            self.people(search(data.name, data.sortExpression));
	            self.sortExpression(data.sortExpression.indexOf('DESC') === -1 ? 'Name DESC' : 'Name');
	        };
	        webMailStates.list.dispose = function () { };
	        webMailStates.details.navigated = function (data) {
	        };
	        webMailStates.details.dispose = function () {  };
	        Navigation.start();
        };

        Navigation.StateInfoConfig.build([
	        { key: 'person', initial: 'list', states: [
		        { key: 'list', route: '{sortExpression}', defaults: {sortExpression: 'Name'}, trackCrumbTrail: false, transitions: [
			        { key: 'select', to: 'details' }]},
		        { key: 'details', route: 'person' }]}
        ]);
        ko.applyBindings(new PersonViewModel());
    </script>
</body>
</html>
