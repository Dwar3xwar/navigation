<!DOCTYPE html>
<html>
<head>
    <title>Passing Data</title>
    <meta name="viewport" content="width=device-width">
    <link href="codemirror.css" rel="stylesheet" />
    <link href="tutorial.css" rel="stylesheet" />
    <style>
        .CodeMirror { height:380px; }
    </style>
</head>
<body>
    <div id="header">
        <div id="banner">
            <a id="home" href="../index.html">Navigation</a>
            <a class="active" href="configuringstates.html">Tutorial</a>
            <a href="../example/angular/navigation.html">Examples</a>
            <a href="../download/index.html">Download</a>
            <a href="../documentation/configuring.html">Documentation</a>
            <a href="https://github.com/grahammendick/navigation">GitHub Source</a>
        </div>
    </div>
    <div id="content">
        <div id="tutorial">
            <h3>Exercises</h3>
            <ol>
                <li><a id="e1">Configuring States</a></li>
                <li><a id="e2">Accessing States</a></li>
                <li><a id="e3">Navigating to a Dialog</a></li>
                <li><a id="e4">Creating a State Navigator</a></li>
                <li><a id="e5">Configuring a Transition</a></li>
                <li><a id="e6">Navigating along a Transition</a></li>
                <li><a id="e7">Navigating Back</a></li>
                <li><a id="e8">Passing Data</a></li>
                <li><a id="e9">Refreshing</a></li>
                <li><a id="e10">Remembering Data</a></li>
                <li><a id="e11">Tidying Up the Url</a></li>
            </ol>
        </div>
        <div id="exercise">
            <h1>Exercise 8: Passing Data</h1>
            <p>
                When a user selects a person to edit, you need to pass the id of the person to the details State. You need this id
                so you can fetch the person in the details State navigator. The navigate function used to change State allows
                you to pass this data in the second parameter. A copy of this data is then passed in to your State navigator. In
                this exercise, you'll pass an id from the listing state and access it in the details State navigator.
            </p>
            <textarea id="code"></textarea>
            <button id="run">Run</button>
            <button id="cheat">Cheat</button>
            <button id="next">Next</button>
        </div>
    </div>
    <script>
        var tutorial = {
            part: 8,
            exercise:
"function(result){\n\
	Navigation.StateInfoConfig.build([{\n\
		key: '{dialog}', initial: '{listing}', states: [\n\
			{ key: '{listing}', route: 'people', transitions: [\n\
				{ key: '{transition}', to: '{details}' }\n\
			]},\n\
    		{ key: '{details}', route: 'person' }\n\
		]\n\
	}]);\n\
	var dialogs = Navigation.StateInfoConfig.dialogs;\n\
	var dialog = dialogs.{dialog};\n\
	/*-------------------------EXERCISE-------------------------\n\
	 * Pass an id of 10 from the listing State to the details\n\
	 * State. Retrieve the id from the data object passed in to\n\
	 * the details State navigator and assign it to the \n\
	 * 'result.id' property. \n\
	 */\n\
	dialog.states.{details}.navigated = function(data){\n\
		result.id = ?;\n\
	}\n\
	Navigation.StateController.navigate(?);\n\
	Navigation.StateController.navigate(?, { id: 10 });\n\
}",
            answer:
"function(result){\n\
	Navigation.StateInfoConfig.build([{\n\
		key: '{dialog}', initial: '{listing}', states: [\n\
			{ key: '{listing}', route: 'people', transitions: [\n\
				{ key: '{transition}', to: '{details}' }\n\
			]},\n\
    		{ key: '{details}', route: 'person' }\n\
		]\n\
	}]);\n\
	var dialogs = Navigation.StateInfoConfig.dialogs;\n\
	var dialog = dialogs.{dialog};\n\
	result.id = null;\n\
	dialog.states.{details}.navigated = function(data){\n\
		result.id = data.id;\n\
	}\n\
	Navigation.StateController.navigate('{dialog}');\n\
	Navigation.StateController.navigate('{transition}', { id: 10 });\n\
}",
            test: function (listing, details, result) {
                if (result.id !== 10)
                    throw "'result.id' isn't set to 10";
                if (Navigation.StateContext.data.id !== 10)
                    throw "You didn't pass an id of 10 to the details State";
                if (Navigation.StateContext.state !== details)
                    throw "The current State isn't the details State";
                if (Navigation.StateContext.previousState !== listing)
                    throw "The previous State isn't the listing State";
            }
        }
    </script>
    <script src="../navigation.js"></script>
    <script src="codemirror.js"></script>
    <script src="javascript.js"></script>
    <script src="tutorial.js"></script>
</body>
</html>
