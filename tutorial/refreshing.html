<!DOCTYPE html>
<html>
<head>
    <title>Refreshing</title>
    <link href="codemirror.css" rel="stylesheet" />
    <link href="tutorial.css" rel="stylesheet" />
    <style>
        .CodeMirror { height:365px; }
    </style>
</head>
<body>
    <div id="header">
        <div id="banner">
            <a id="home" href="../index.html">Navigation</a>
            <a class="active" href="configuringstates.html">Tutorial</a>
            <a href="../example/angular/navigation.html">Examples</a>
            <a href="https://github.com/grahammendick/navigation">GitHub Source</a>
        </div>
    </div>
    <div id="content">
        <div id="tutorial">
            <h3>Exercises</h3>
            <ol>
                <li><a id="e1">Configuring States</a></li>
                <li><a id="e2">Accessing States</a></li>
                <li><a id="e3">Navigating to a Dialog</a></li>
                <li><a id="e4">Creating a State Controller</a></li>
                <li><a id="e5">Configuring a Transition</a></li>
                <li><a id="e6">Navigating along a Transition</a></li>
                <li><a id="e7">Navigating Back</a></li>
                <li><a id="e8">Passing Data</a></li>
                <li><a id="e9">Refreshing</a></li>
                <li><a id="e10">Remembering Data</a></li>
                <li><a id="e11">Tidying Up the Url</a></li>
            </ol>
        </div>
        <div id="exercise">
            <h1>Exercise 9: Refreshing</h1>
            <p>
                The user has to page through the grid of people because there are too many to show all at once. As the user pages
                through the grid you want to keep them on the listing State but pass the new page number into the listing State
                controller. Changing data without changing State is called refreshing. This is the third and final type of
                navigation - the other two you've met are forward (to a Dialog or along a Transtion) and back. In this exercise,
                you'll refresh the pageNumber of the listing State.
            </p>
            <textarea id="code"></textarea>
            <button id="run">Run</button>
            <button id="cheat">Cheat</button>
            <button id="next">Next</button>
        </div>
    </div>
    <script>
        var tutorial = {
            part: 9,
            exercise:
"function(result){\n\
	Navigation.StateInfoConfig.build([{\n\
		key: '{dialog}', initial: '{listing}', states: [\n\
			{ key: '{listing}', route: 'people', transitions: [\n\
				{ key: '{transition}', to: '{details}' }\n\
			]},\n\
    		{ key: '{details}', route: 'person' }\n\
		]\n\
	}]);\n\
	var dialogs = Navigation.StateInfoConfig.dialogs;\n\
	var dialog = dialogs.{dialog};\n\
	dialog.states.{listing}.navigated = function(data){\n\
		result.pageNumber = data.pageNumber;\n\
	}\n\
	/*-------------------------EXERCISE-------------------------\n\
	 * Refresh the listing State passing a pageNumber of 2.\n\
	 * Remember, you must navigate to the listing State before\n\
	 * you can refresh it.\n\
	 */\n\
	 ?\n\
	 Navigation.StateController.refresh(?);\n\
}",
            answer:
"function(result){\n\
	Navigation.StateInfoConfig.build([{\n\
		key: '{dialog}', initial: '{listing}', states: [\n\
			{ key: '{listing}', route: 'people', transitions: [\n\
				{ key: '{transition}', to: '{details}' }\n\
			]},\n\
    		{ key: '{details}', route: 'person' }\n\
		]\n\
	}]);\n\
	var dialogs = Navigation.StateInfoConfig.dialogs;\n\
	var dialog = dialogs.{dialog};\n\
	dialog.states.{listing}.navigated = function(data){\n\
		result.pageNumber = data.pageNumber;\n\
	}\n\
	Navigation.StateController.navigate('{dialog}');\n\
	Navigation.StateController.refresh({ pageNumber: 2 });\n\
}",
            test: function (listing, details, result) {
                if (result.pageNumber !== 2)
                    throw "'result.pageNumber' isn't set to 2";
                if (Navigation.StateContext.data.pageNumber !== 2)
                    throw "You didn't pass a pageNumber of 2 to the listing State";
                if (Navigation.StateContext.state !== listing)
                    throw "The current State isn't the listing State";
                if (Navigation.StateContext.previousState !== listing)
                    throw "The previous State isn't the listing State";
            }
        }
    </script>
    <script src="navigation.js"></script>
    <script src="codemirror.js"></script>
    <script src="javascript.js"></script>
    <script src="tutorial.js"></script>
</body>
</html>
