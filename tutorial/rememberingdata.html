<!DOCTYPE html>
<html>
<head>
    <title>Remembering Data</title>
    <link href="codemirror.css" rel="stylesheet" />
    <link href="tutorial.css" rel="stylesheet" />
    <style>
        .CodeMirror { height:440px; }
    </style></head>
<body>
    <div id="header">
        <div id="banner">
            <a id="home" href="../index.html">Navigation</a>
            <a class="active" href="configuringstates.html">Tutorial</a>
            <a href="../example/angular/navigation.html">Examples</a>
            <a href="https://github.com/grahammendick/navigation">GitHub Source</a>
        </div>
    </div>
    <div id="content">
        <div id="tutorial">
            <h3>Exercises</h3>
            <ol>
                <li><a id="e1">Configuring States</a></li>
                <li><a id="e2">Accessing States</a></li>
                <li><a id="e3">Navigating to a Dialog</a></li>
                <li><a id="e4">Creating a State Controller</a></li>
                <li><a id="e5">Configuring a Transition</a></li>
                <li><a id="e6">Navigating along a Transition</a></li>
                <li><a id="e7">Navigating Back</a></li>
                <li><a id="e8">Passing Data</a></li>
                <li><a id="e9">Refreshing</a></li>
                <li><a id="e10">Remembering Data</a></li>
                <li><a id="e11">Tidying Up the Url</a></li>
            </ol>
        </div>
        <div id="exercise">
            <h1>Exercise 10: Remembering Data</h1>
            <p>
                The user's selected a person from the second page. After they've edited that person, they navigate back to the
                listing State to select the next person. They'd be disappointed if you didn't return them to the second page so
                they could continue where they left off. When Navigation builds its dynamic breadcrumb trail it tracks the data
                along with the State. When you navigate back this data is passed back into your State controller. In this exercise,
                you'll see the pageNumber is remembered when returning to the listing State from the details State.
            </p>
            <textarea id="code"></textarea>
            <button id="run">Run</button>
            <button id="cheat">Cheat</button>
            <button id="next">Next</button>
        </div>
    </div>
    <script>
        var tutorial = {
            part: 10,
            exercise:
"function(result){\n\
	Navigation.StateInfoConfig.build([{\n\
		key: '{dialog}', initial: '{listing}', states: [\n\
			{ key: '{listing}', route: 'people', transitions: [\n\
				{ key: '{transition}', to: '{details}' }\n\
			]},\n\
    		{ key: '{details}', route: 'person' }\n\
		]\n\
	}]);\n\
	var dialogs = Navigation.StateInfoConfig.dialogs;\n\
	var dialog = dialogs.{dialog};\n\
	dialog.states.{listing}.navigated = function(data){\n\
		result.pageNumber = data.pageNumber;\n\
	}\n\
	/*-------------------------EXERCISE-------------------------\n\
	 * Navigate back to keep the pageNumber the user was on when\n\
	 * they navigated to the details State. Fill in the blanks:\n\
	 * 1. Navigate to the listing State.\n\
	 * 2. Refresh the listing State, passing a pageNumber of 2.\n\
	 * 3. Navigate to the details State.\n\
	 * 4. Navigate back to the listing State.\n\
	 */\n\
	 ?\n\
	 ?\n\
	 ?\n\
	 ?\n\
}",
            answer:
"function(result){\n\
	Navigation.StateInfoConfig.build([{\n\
		key: '{dialog}', initial: '{listing}', states: [\n\
			{ key: '{listing}', route: 'people', transitions: [\n\
				{ key: '{transition}', to: '{details}' }\n\
			]},\n\
    		{ key: '{details}', route: 'person' }\n\
		]\n\
	}]);\n\
	var dialogs = Navigation.StateInfoConfig.dialogs;\n\
	var dialog = dialogs.{dialog};\n\
	dialog.states.{listing}.navigated = function(data){\n\
		result.pageNumber = data.pageNumber;\n\
	}\n\
	Navigation.StateController.navigate('{dialog}');\n\
	Navigation.StateController.refresh({ pageNumber: 2 });\n\
	Navigation.StateController.navigate('{transition}');\n\
	Navigation.StateController.navigateBack(1);\n\
}",
            test: function (listing, details, result) {
                if (result.pageNumber !== 2)
                    throw "'result.pageNumber' isn't set to 2";
                if (Navigation.StateContext.data.pageNumber !== 2)
                    throw "You didn't remember a pageNumber of 2";
                if (Navigation.StateContext.state !== listing)
                    throw "The current State isn't the listing State";
                if (Navigation.StateContext.previousState !== details)
                    throw "The previous State isn't the details State";
            }
        }
    </script>
    <script src="navigation.js"></script>
    <script src="codemirror.js"></script>
    <script src="javascript.js"></script>
    <script src="tutorial.js"></script>
</body>
</html>
